<!DOCTYPE html > 
<html>
<head>
	<title> wo的文章 </title>
	<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" /> 
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.1/bootstrap-table.min.css">
	<!-- jQuery -->
    <script type="text/javascript" src="http://code.changer.hk/jquery/1.11.2/jquery.min.js"></script>
    <script type="text/javascript" src="http://code.changer.hk/jquery/plugins/jquery.cookie.js"></script>
</head>
<body>
    
<div class="s_article"></div>
<button id="del">删除该文章</button>
<button id="rew">修改文章</button>
<div class="s_comment"></div>
<button id="com">回复评论</button>
<button id="del_com">删除评论</button>

	
<script type="text/javascript">
		var search_url = "./beforemt.php";
		var aId = window.location.href.split('article_id=')[1];
		
		//前端获取后台数据并呈现方法
		function information_display() {
                  //alert (aId);	测试是否获取了参数	
			    $.ajax({
                    type: "get",
                    url: search_url,
                    dataType: 'json',
					data: aId,
                    contentType: 'application/json; charset=utf-8',
                    success: function(data) {
                        //测试是否可以拿到php中的数据
                        console.log(data);
                        //遍历这个数组
						
			       
					var itemArr = data.data;  
					var itemArr1 = data.data1;   //分别获得文章和评论信息
			    $.each(itemArr, function (index, n) {
					
			        $(".s_article").empty()
				    var article = "<table>"
					+ "<tr >"
					+ "<td>" + n.id + "</td>"
					+ "<td>" + n.title + "</td>"
					+ "<td>" + n.subtime + "</td>"
					+ "<td>" + n.love + "</td>"
					+ "<td>" + n.content + "</td>"	
                   // + "<td>" + "<a href='./delarticle.php?article_id="+n.id + "'>" + "删除" + "</a>" + "</td>"					
					+ "</tr>"
					+ "</table>";					
					
				    $(".s_article").append(article)  //将信息插入相应区域			       															
			        })
					
				$.each(itemArr1, function (index, m) {
					
					$(".s_comment").empty()					
					var comment = "<table>"
					+ "<tr >"
					+ "<td>" + m.id + "</td>"
					+ "<td>" + m.userid + "</td>"
					+ "<td>" + m.content + "</td>"
					+ "<td>" + m.datetime + "</td>"	
                  //  + "<td>" + "<a href='./del_comment.php?article_id="+m.id + "'>" + "删除" + "</a>" + "</td>"						
					+ "</tr>"
					+ "</table>";
					
					$(".s_comment").append(comment) //将信息插入相应区域			       															
			        })										
																			
					
                    },
					
                    error: function(msg) {
                        alert(msg);
                    },
                });																																	
		}		
		
		//初始化加载		
		window.onload = function () {			
			information_display();
		}
		
$(document).ready(function(){
    //不同的按钮执行不同动作
    $("#del").click(function(){   
        var dataParam = {
                action: "delete_article"
            };			
		var action_url: "./myatc_cl.php";
		
		$.ajax({
            type: "get",
            url: action_url,
			data: dataParam,
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',
            success: function(data){
				alert(data);
            },					
            error: function(msg){
                alert(msg);
            },
        });	
    });
	
	$("#rew").click(function(){
        var dataParam = {
                action: "rewrite"
            };
		var action_url: "./myatc_cl.php";
		
		$.ajax({
            type: "get",
            url: action_url,
			data: dataParam,
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',
            success: function(data){
				alert(data);
            },					
            error: function(msg){
                alert(msg);
            },
        });	
    });
	
	$("#com").click(function(){
        var dataParam = {
                action: "write_comment"
            };
		var action_url: "./myatc_cl.php";
		
		$.ajax({
            type: "get",
            url: action_url,
			data: dataParam,
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',
            success: function(data){
				alert(data);
            },					
            error: function(msg){
                alert(msg);
            },
        });	
    });	

	$("#del_com").click(function(){
        var dataParam = {
                action: "delete_comment"
            };
		var action_url: "./myatc_cl.php";
		
		$.ajax({
            type: "get",
            url: action_url,
			data: dataParam,
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',
            success: function(data){
				alert(data);
            },					
            error: function(msg){
                alert(msg);
            },
        });	
    });		
 
});
	</script>
</body>
</html>